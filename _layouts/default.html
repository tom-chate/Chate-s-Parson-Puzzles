<!DOCTYPE html>
<html
  lang="{{ site.lang | default: 'en-US' }}"
  data-theme="default"
  data-font="default"
>
  <head>
    {%- include parsons-scripts.html -%}

    {% if site.google_analytics %}
      <script async src="https://www.googletagmanager.com/gtag/js?id={{ site.google_analytics }}"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', '{{ site.google_analytics }}');
      </script>
    {% endif %}

    <meta charset="UTF-8">
    {% seo %}
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    >

    <!-- Bootstrap Icons -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
    >

    <!-- OpenDyslexic font -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/open-dyslexic@0.0.3/open-dyslexic.min.css"
    >

    <!-- Jekyll-compiled CSS -->
    <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
  </head>


  <body class="d-flex flex-column min-vh-100">
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
      <div class="container-fluid">

        <!-- Brand -->
        <a class="navbar-brand fw-bold d-flex align-items-center gap-2"
           href="{{ '/' | relative_url }}">
          <i class="bi bi-house-fill"></i>
          Ed-Chate
        </a>

        <button class="navbar-toggler" type="button"
          data-bs-toggle="collapse"
          data-bs-target="#mainNavbar"
          aria-controls="mainNavbar"
          aria-expanded="false"
          aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="mainNavbar">
          <!-- Left side: Parson Puzzles -->
  <!-- Left side: Parson Puzzles with category submenus -->
<ul class="navbar-nav ms-3 me-auto">
  <li class="nav-item dropdown">
    <a class="nav-link dropdown-toggle"
       href="#"
       id="puzzlesDropdown"
       role="button"
       data-bs-toggle="dropdown"
       aria-expanded="false">
      <i class="bi bi-cpu"></i> Parson Puzzles
    </a>

    <ul class="dropdown-menu" aria-labelledby="puzzlesDropdown">
      {% assign grouped = site.data.tasks | group_by: "category" %}
      {% for group in grouped %}
        <li class="dropdown-submenu dropend">
          <a class="dropdown-item dropdown-toggle" href="#">
            {{ group.name }}
          </a>
          <ul class="dropdown-menu">
            {% for task in group.items %}
              {% assign task_url = '/parsons/' | append: task.slug | append: '.html' %}
              <li>
                <a class="dropdown-item{% if page.url == task_url %} active{% endif %}"
                   href="{{ task_url | relative_url }}">
                  {{ task.title }}
                </a>
              </li>
            {% endfor %}
          </ul>
        </li>
      {% endfor %}
    </ul>
  </li>
</ul>



          <!-- Right side: current page title -->
          <span class="navbar-text small text-truncate">
            {{ page.title | default: site.title }}
          </span>
        </div>
      </div>
    </nav>

    <!-- Main content -->
    <main id="content" class="main-content container my-4 flex-grow-1" role="main">
      {{ content }}
    </main>

    <!-- Footer -->
    <footer class="mt-auto py-3 bg-dark text-light">
      <div class="container d-flex flex-wrap align-items-center justify-content-between gap-2">
        <small>Â© {{ site.time | date: "%Y" }} Ed-Chate</small>

        <div class="d-flex align-items-center gap-3 footer-actions">
          <!-- YouTube link -->
          <a
            href="https://www.youtube.com/@edu-chate"
            target="_blank"
            rel="noopener"
            class="text-light text-decoration-none d-flex align-items-center gap-1 footer-link"
          >
            <i class="bi bi-youtube"></i>
            <span>YouTube</span>
          </a>

          <!-- Accessibility dropdown -->
          <div class="dropdown">
            <button
              class="btn btn-sm btn-outline-light dropdown-toggle"
              type="button"
              id="accessibilityDropdown"
              data-bs-toggle="dropdown"
              aria-expanded="false"
            >
              <i class="bi bi-universal-access"></i>
              Accessibility
            </button>
            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="accessibilityDropdown">
              <li class="dropdown-header">Colour theme</li>
              <li>
                <button class="dropdown-item" type="button" onclick="setTheme('default')">
                  Default
                </button>
              </li>
              <li>
                <button class="dropdown-item" type="button" onclick="setTheme('overlay-yellow')">
                  Yellow overlay
                </button>
              </li>
              <li>
                <button class="dropdown-item" type="button" onclick="setTheme('overlay-blue')">
                  Blue overlay
                </button>
              </li>
              <li>
                <button class="dropdown-item" type="button" onclick="setTheme('high-contrast')">
                  High contrast
                </button>
              </li>

              <li><hr class="dropdown-divider"></li>

              <li class="dropdown-header">Font</li>
              <li>
                <button class="dropdown-item" type="button" onclick="setFont('default')">
                  Default font
                </button>
              </li>
              <li>
                <button class="dropdown-item" type="button" onclick="setFont('opendyslexic')">
                  OpenDyslexic
                </button>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </footer>

    <!-- Bootstrap JS bundle -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>

    <!-- Theme & font switching logic -->
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const root = document.documentElement;

        // Restore saved theme & font
        const savedTheme = localStorage.getItem('theme');
        const savedFont = localStorage.getItem('font');

        if (savedTheme) {
          root.setAttribute('data-theme', savedTheme);
        }
        if (savedFont) {
          root.setAttribute('data-font', savedFont);
        }

        // Expose helpers for buttons
        window.setTheme = function(theme) {
          root.setAttribute('data-theme', theme);
          localStorage.setItem('theme', theme);
        };

        window.setFont = function(font) {
          root.setAttribute('data-font', font);
          localStorage.setItem('font', font);
        };
      });
    </script>
  </body>
</html>
